/* =========================================
   移动端终极防闪屏与性能优化补丁
   ========================================= */

/* 1) 修复手机视口抖动与原生回弹闪烁 */
html, body {
  height: 100%;
  min-height: 100dvh;
  /* 禁用下拉刷新和边界橡皮筋效果，防止图层撕裂 */
  overscroll-behavior-y: none; 
  -webkit-tap-highlight-color: transparent;
}

/* 2) 强制开启 GPU 硬件加速 
   给所有全屏滑动面板加上 3D 属性，防止动画过程中掉帧闪屏 */
.app-fullscreen-view, 
.chat-view, 
.settings-view, 
.pay-sub-page,
.k-full-modal,
.modify-modal-view {
    -webkit-backface-visibility: hidden !important;
    backface-visibility: hidden !important;
    perspective: 1000;
}

/* 3) 移动端降级：干掉最吃性能的模糊特效 */
@media (max-width: 900px) {
  /* 手机端彻底关闭高斯模糊，它是导致安卓闪屏的最大元凶 */
  .chat-view, 
  .settings-view, 
  .dock-bar, 
  .wc-tab-bar, 
  .wc-plus-dropdown, 
  .modal-overlay, 
  .modal-box,
  .chat-header,
  .settings-header,
  #coin-game-view {
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    background-color: rgba(255, 255, 255, 0.98) !important; /* 用极高不透明度代替模糊 */
  }

  /* 手机端关闭发票边缘的遮罩裁剪（极耗性能） */
  .ticker-wrapper, 
  .receipt-widget.short-version {
    mask-image: none !important;
    -webkit-mask-image: none !important;
  }
}
